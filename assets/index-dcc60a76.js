import{I as Q}from"./index-033b4f4e.js";import{g as V,h as D,f as W}from"./elements-66cdcec2.js";import{d as $,e as Z,i as G,c as H,a as P}from"./components-b798c95f.js";import{d as J,a as n,b as h,w as K,W as X,n as x,Z as N,_ as M,p as ee,f as p,h as A,M as te,q as ae,N as w,R as oe,O as se,aC as ne,i as B,S as E,ap as L,ai as le,P as re,Q as ue,F as ce}from"./vue-router-0bbd6486.js";import{C as ie}from"./index-604abe5c.js";import{d as de}from"./index-dd768cde.js";import"./shared-39a089ed.js";import"./logger-525ef361.js";import"./index-9e1b28d2.js";import"./index-727aa21f.js";/* empty css               */const ve={modelValue:{type:Boolean},disabled:{type:Boolean,default:!1},animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:{type:String},successBgColor:{type:String},color:{type:String},successColor:{type:String},target:{type:[String,Object]},onRefresh:$(),"onUpdate:modelValue":$()},{n:O,classes:fe}=H("pull-refresh"),Y=150,me=J({name:"VarPullRefresh",components:{VarIcon:Q},props:ve,setup(e){const a=n(0),v=n(null),i=n(null),d=n(0),s=n("-125%"),l=n("arrow-down"),t=n("default"),r=n(!1);let u,m,C=0,S=0;const b=async o=>{if(l.value!==o)return l.value=o,new Promise(c=>{window.setTimeout(c,Y)})},I=h(()=>t.value!=="loading"&&t.value!=="success"&&!e.disabled),U=h(()=>({transform:`translate3d(0px, ${X(s.value)?s.value:`${s.value}px`}, 0px) translate(-50%, 0)`,transition:r.value?`transform ${e.animationDuration}ms`:void 0,background:y.value?e.successBgColor:e.bgColor,color:y.value?e.successColor:e.color})),f=h(()=>Math.abs(2*a.value)),y=h(()=>t.value==="success"),T=o=>{("classList"in u?u:document.body).classList[o](`${O()}--lock`)},z=o=>{if(a.value===0){const{width:c}=i.value.getBoundingClientRect();a.value=-(c+c*.25)}C=o.touches[0].clientY,S=0,m=V(o.target)},_=o=>{if(!I.value||m!==u&&D(m)>0)return;const c=D(u);if(c>0)return;const R=c===0;S=o.touches[0].clientY-C,R&&S>=0&&o.preventDefault(),t.value!=="pulling"&&(t.value="pulling",d.value=o.touches[0].clientY),R&&s.value>a.value&&T("add");const k=(o.touches[0].clientY-d.value)/2+a.value;s.value=k>=f.value?f.value:k,b(s.value>=f.value*.2?"refresh":"arrow-down")},F=async()=>{I.value&&(r.value=!0,s.value>=f.value*.2?(await b("refresh"),t.value="loading",s.value=f.value*.3,P(e["onUpdate:modelValue"],!0),x(()=>{P(e.onRefresh)}),T("remove")):(t.value="loosing",l.value="arrow-down",s.value=a.value,setTimeout(()=>{r.value=!1,T("remove")},N(e.animationDuration))),m=null)},j=()=>{u=e.target?W(e.target,"PullRefresh"):V(v.value)},q=()=>{setTimeout(()=>{t.value="default",l.value="arrow-down",r.value=!1},N(e.animationDuration))};return K(()=>e.modelValue,o=>{o===!1&&(r.value=!0,t.value="success",l.value="checkbox-marked-circle",setTimeout(()=>{s.value=a.value,q()},N(e.successDuration)))}),Z(j),G(v,"touchmove",_),{n:O,classes:fe,ICON_TRANSITION:Y,refreshStatus:t,freshNode:v,controlNode:i,touchStart:z,touchMove:_,touchEnd:F,iconName:l,controlStyle:U,isSuccess:y}}});function he(e,a,v,i,d,s){const l=ee("var-icon");return p(),A("div",{ref:"freshNode",class:w(e.n()),onTouchstart:a[0]||(a[0]=(...t)=>e.touchStart&&e.touchStart(...t)),onTouchend:a[1]||(a[1]=(...t)=>e.touchEnd&&e.touchEnd(...t)),onTouchcancel:a[2]||(a[2]=(...t)=>e.touchEnd&&e.touchEnd(...t))},[te("div",{ref:"controlNode",class:w(e.classes(e.n("control"),e.n("$-elevation--2"),[e.isSuccess,e.n("control-success")])),style:oe(e.controlStyle)},[ae(l,{name:e.iconName,transition:e.ICON_TRANSITION,class:w(e.classes(e.n("icon"),[e.refreshStatus==="loading",e.n("animation")])),"var-pull-refresh-cover":""},null,8,["name","transition","class"])],6),se(e.$slots,"default")],34)}const g=M(me,[["render",he]]);g.install=function(e){e.component(g.name,g)};const pe={__name:"index",setup(e){const a=Array(30).fill("List Item"),v=Array(30).fill("This is new List Item"),i=n(!1),d=n(a);function s(){setTimeout(()=>{d.value=d.value[0]==="List Item"?v:a,i.value=!1},2e3)}return ne(de),(l,t)=>(p(),B(L(g),{onRefresh:s,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=r=>i.value=r),"success-duration":"2000"},{default:E(()=>[(p(!0),A(ce,null,le(d.value,(r,u)=>(p(),B(L(ie),{key:u,border:""},{default:E(()=>[re(ue(r+" "+(u+1)),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]))}},Ve=M(pe,[["__scopeId","data-v-6f15a34c"]]);export{Ve as default};
