import{F as Se,u as ye}from"./provide-1db4002d.js";import{d as $,k as ke,a as k,e as pe,c as Fe}from"./components-b798c95f.js";import{H as Ne,u as ee}from"./index-fbb0fcba.js";import{v as Ce}from"./index-5cbdb505.js";import{m as Te,l as He}from"./elements-66cdcec2.js";import{w as te}from"./logger-525ef361.js";import{d as Pe,a as B,r as we,b as p,w as re,Z as o,ax as v,ap as W,X as E,n as ze,_ as Le,p as ae,ag as De,f as A,h as I,M as h,N as c,R as F,F as $e,ai as Me,ah as ne,O as Ue,D as Be,q as le,Q as We}from"./vue-router-0bbd6486.js";function Ee(e){return["always","normal","never"].includes(e)}var l=(e=>(e.First="1",e.Second="2",e))(l||{});const Ae={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:Ee},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},max:{type:[String,Number],default:100},min:{type:[String,Number],default:0},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},rules:{type:Array},onChange:$(),onStart:$(),onEnd:$(),"onUpdate:modelValue":$()},{n:oe,classes:Ie}=Fe("slider"),Oe=Pe({name:"VarSlider",components:{VarFormDetails:Se,VarHoverOverlay:Ne},directives:{Hover:Ce},props:Ae,setup(e){const{bindForm:C,form:f}=ye(),{errorMessage:X,validateWithTrigger:R,validate:q,resetValidation:T}=ke(),{hovering:H,handleHovering:P}=ee(),{hovering:s,handleHovering:d}=ee(),se=()=>q(e.rules,e.modelValue),Q=()=>({startPosition:0,currentLeft:0,active:!1,percentValue:0}),ie=()=>ze(()=>R(["onChange"],"onChange",e.rules,e.modelValue)),M=B(null),b=B(0),w=B(!1),n=we({[l.First]:Q(),[l.Second]:Q()}),U=p(()=>o(e.max)-o(e.min)),g=p(()=>b.value/U.value*o(e.step)),ue=p(()=>{const{modelValue:t,range:r}=e;let a=[];return r&&v(t)?a=[{value:S(t[0]),enumValue:l.First,text:N(t[0]),hovering:W(H),handleHovering:P},{value:S(t[1]),enumValue:l.Second,text:N(t[1]),hovering:W(s),handleHovering:d}]:E(t)&&(a=[{value:S(t),enumValue:l.First,text:N(t),hovering:W(H),handleHovering:P}]),a}),ce=p(()=>{const{activeColor:t,range:r,modelValue:a}=e,i=r&&v(a)?S(Math.min(a[0],a[1])):0;return{width:`${r&&v(a)?S(Math.max(a[0],a[1]))-i:S(a)}%`,left:`${i}%`,background:t}}),m=p(()=>e.disabled||(f==null?void 0:f.disabled.value)),z=p(()=>e.readonly||(f==null?void 0:f.readonly.value)),de=t=>e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:n[t].active,S=t=>{const{min:r,max:a}=e;return t<o(r)?0:t>o(a)?100:(t-o(r))/U.value*100},N=t=>{if(!E(t))return 0;let r=t;return r<Number(e.min)&&(r=Number(e.min)),r>Number(e.max)&&(r=Number(e.max)),parseInt(`${r}`,10)===r?r:o(r.toPrecision(5))},ve=(t,r)=>{m.value||r.handleHovering(t)},Z=(t,r)=>{let a=[];const{step:i,range:u,modelValue:V,onChange:L,min:y}=e,Y=o(i),_=Math.round(t/g.value),D=_*Y+o(y),ge=n[r].percentValue*Y+o(y);if(n[r].percentValue=_,u&&v(V)&&(a=r===l.First?[D,V[1]]:[V[0],D]),ge!==D){const x=u?a.map(Ve=>N(Ve)):N(D);k(L,x),k(e["onUpdate:modelValue"],x),ie()}},me=t=>{if(!e.range)return l.First;const r=n[l.First].percentValue*g.value,a=n[l.Second].percentValue*g.value,i=Math.abs(t-r),u=Math.abs(t-a);return i<=u?l.First:l.Second},he=(t,r)=>{b.value||(b.value=M.value.offsetWidth),m.value||(n[r].active=!0),!(m.value||z.value)&&(k(e.onStart),w.value=!0,n[r].startPosition=t.touches[0].clientX)},fe=(t,r)=>{if(m.value||z.value||!w.value)return;let a=t.touches[0].clientX-n[r].startPosition+n[r].currentLeft;a<=0?a=0:a>=b.value&&(a=b.value),Z(a,r)},j=t=>{const{range:r,modelValue:a,onEnd:i,step:u,min:V}=e;if(m.value||(n[t].active=!1),m.value||z.value)return;let L=[];n[t].currentLeft=n[t].percentValue*g.value;const y=n[t].percentValue*o(u)+o(V);r&&v(a)&&(L=t===l.First?[y,a[1]]:[a[0],y]),k(i,r?L:y),w.value=!1},be=t=>{if(m.value||z.value||t.target.closest(`.${oe("thumb")}`))return;const r=t.clientX-He(t.currentTarget),a=me(r);Z(r,a),j(a)},G=()=>{const t=o(e.step);return isNaN(t)?(te("Slider",'type of prop "step" should be Number'),!1):t<0?(te("Slider",'"step" should be > 0'),!1):!0},J=()=>{const{range:t,modelValue:r}=e;return t&&!v(r)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!t&&v(r)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):t&&v(r)&&r.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0},K=(t=e.modelValue,r=o(e.step))=>{const a=i=>{const{min:u,max:V}=e;return i<o(u)?0:i>o(V)?U.value/r:(i-o(u))/r};e.range&&v(t)?(n[l.First].percentValue=a(t[0]),n[l.First].currentLeft=n[l.First].percentValue*g.value,n[l.Second].percentValue=a(t[1]),n[l.Second].currentLeft=n[l.Second].percentValue*g.value):E(t)&&(n[l.First].currentLeft=a(t)*g.value)};return k(C,{reset:()=>{const t=e.range?[0,0]:0;k(e["onUpdate:modelValue"],t),T()},validate:se,resetValidation:T}),re([()=>e.modelValue,()=>e.step],([t,r])=>{!G()||!J()||w.value||K(t,o(r))}),re(b,()=>K()),pe(()=>{!G()||!J()||(b.value=M.value.offsetWidth)}),{n:oe,classes:Ie,Thumbs:l,sliderEl:M,getFillStyle:ce,isDisabled:m,errorMessage:X,thumbsProps:n,thumbList:ue,hover:ve,multiplySizeUnit:Te,toNumber:o,showLabel:de,start:he,move:fe,end:j,click:be}}});const Xe=["onTouchstart","onTouchmove","onTouchend","onTouchcancel"];function Re(e,C,f,X,R,q){const T=ae("var-hover-overlay"),H=ae("var-form-details"),P=De("hover");return A(),I("div",{class:c(e.n())},[h("div",{class:c(e.classes(e.n("block"),[e.isDisabled,e.n("--disabled")],[e.errorMessage,e.n("--error")])),ref:"sliderEl",onClick:C[0]||(C[0]=(...s)=>e.click&&e.click(...s))},[h("div",{class:c(e.n("track"))},[h("div",{class:c(e.n("track-background")),style:F({background:e.trackColor,height:e.multiplySizeUnit(e.trackHeight)})},null,6),h("div",{class:c(e.n("track-fill")),style:F(e.getFillStyle)},null,6)],2),(A(!0),I($e,null,Me(e.thumbList,s=>(A(),I("div",{class:c(e.n("thumb")),key:s.enumValue,style:F({left:`${s.value}%`,zIndex:e.thumbsProps[s.enumValue].active?1:void 0}),onTouchstart:ne(d=>e.start(d,s.enumValue),["stop"]),onTouchmove:ne(d=>e.move(d,s.enumValue),["stop"]),onTouchend:d=>e.end(s.enumValue),onTouchcancel:d=>e.end(s.enumValue)},[Ue(e.$slots,"button",{currentValue:s.text},()=>[Be(h("div",{class:c(e.n("thumb-block")),style:F({background:e.thumbColor})},null,6),[[P,d=>e.hover(d,s),"desktop"]]),h("div",{class:c(e.classes(e.n("thumb-ripple"),[e.thumbsProps[s.enumValue].active,e.n("thumb-ripple--active")])),style:F({background:e.thumbsProps[s.enumValue].active?e.thumbColor:void 0})},[le(T,{hovering:s.hovering},null,8,["hovering"])],6),h("div",{class:c(e.classes(e.n("thumb-label"),[e.showLabel(s.enumValue),e.n("thumb-label--active")])),style:F({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2),width:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2)})},[h("span",null,We(s.text),1)],6)])],46,Xe))),128))],2),le(H,{"error-message":e.errorMessage,class:c(e.n("form")),"var-slider-cover":""},null,8,["error-message","class"])],2)}const O=Le(Oe,[["render",Re]]);O.install=function(e){e.component(O.name,O)};export{O as S};
